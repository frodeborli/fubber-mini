# Writing Documentation for Mini Framework

This guide explains how to write and link documentation in the Mini framework, both in PHP docblocks and markdown files.

## Documentation Systems

Mini uses two complementary documentation systems:

1. **PHP Docblock Documentation** - Automatically generated from class/function docblocks
2. **Markdown Files** - Standalone documentation files in the repository

## PHP Docblock Documentation

### Markdown Support

All docblocks support full GitHub Flavored Markdown syntax:

```php
/**
 * Process user input with advanced validation
 *
 * This method validates input using the following rules:
 * - **Required fields**: name, email
 * - **Optional fields**: phone, address
 * - **Format validation**: email must be valid RFC format
 *
 * ## Example Usage
 *
 * ```php
 * $validator = new Validator();
 * $result = $validator->process($input);
 * ```
 *
 * @param array $input User input data
 * @return ValidationResult Validation result object
 */
function process(array $input): ValidationResult {
    // ...
}
```

Supported markdown features:
- Headings (H2-H6, not H1)
- Bold, italic, code spans
- Code blocks with syntax highlighting
- Lists (ordered and unordered)
- Links (inline and reference-style)
- Tables
- Blockquotes

### PHPDoc Inline Tags

Use `{@see}` to reference classes, methods, or functions:

```php
/**
 * Load configuration from database
 *
 * See {@see mini\Config} for configuration format.
 * Uses {@see mini\Database\Connection::query} internally.
 *
 * @see mini\Logger For logging configuration changes
 */
function loadConfig(): array {
    // ...
}
```

`{@see}` tags are automatically converted to clickable links in the generated documentation.

### URL Structure for Generated Docs

The documentation browser generates clean URLs from PHP namespaces and names:

**Classes/Interfaces/Traits:**
- `mini\Mini` → `/Mini`
- `mini\Util\InstanceStore` → `/Util/InstanceStore`
- `mini\Database\Connection` → `/Database/Connection`

**Functions:**
- `mini\render()` → `/render`
- `mini\Database\connect()` → `/Database/connect`

**Methods:**
- `mini\Mini::bootstrap()` → `/Mini::bootstrap`
- `mini\Util\InstanceStore::offsetExists()` → `/Util/InstanceStore::offsetExists`

**Namespaces:**
- `mini\Hooks` → `/Hooks` (shows all classes/functions in namespace)
- `mini\Database\Drivers` → `/Database/Drivers`

### Linking in Docblocks

**Using `{@see}` tags (recommended):**
```php
/**
 * Create a new database connection
 *
 * {@see mini\Database\Connection} for connection configuration.
 * {@see mini\Config::get} to retrieve connection settings.
 */
```

**Using markdown links:**
```php
/**
 * Create a new database connection
 *
 * See [Connection](/Database/Connection) for configuration.
 * Use [Config::get](/Config::get) to retrieve settings.
 */
```

Both approaches work, but `{@see}` is preferred for consistency.

## Markdown File Documentation

### File Structure

Place markdown files in the framework root or subdirectories:

```
vendor/fubber/mini/
├── README.md              # Root documentation (shows at /mini/)
├── PATTERNS.md            # Available at /mini/PATTERNS
├── REFERENCE.md           # Available at /mini/REFERENCE
└── docs/
    ├── index.md           # Documentation index (optional)
    ├── getting-started.md # Available at /mini/docs/getting-started
    └── advanced/
        ├── index.md       # Advanced topics index (optional)
        └── routing.md     # Available at /mini/docs/advanced/routing
```

### Breadcrumb Generation

Breadcrumbs are automatically generated by walking up the directory tree:

**Algorithm:**
1. Extract first H1 from current file as the last breadcrumb item
2. Walk up directory tree looking for `index.md` files
3. For each `index.md` found, extract first H1 and add to breadcrumb
4. Root breadcrumb comes from `README.md` first H1

**Example for `docs/advanced/routing.md`:**

```markdown
# Advanced Routing Techniques
...
```

If `docs/advanced/index.md` exists:
```markdown
# Advanced Topics
...
```

If `docs/index.md` exists:
```markdown
# Documentation
...
```

And `README.md` has:
```markdown
# Mini Framework
...
```

**Generated breadcrumb:**
`Mini Framework > Documentation > Advanced Topics > Advanced Routing Techniques`

**Without intermediate index.md files:**
`Mini Framework > Advanced Routing Techniques`

**Key points:**
- Only directories with `index.md` appear in breadcrumb
- Breadcrumb uses first H1 from each file, not filenames
- This allows semantic, human-readable breadcrumbs

### Linking Between Markdown Files

Links are automatically resolved relative to `/mini/` base path:

```markdown
See [PATTERNS.md](PATTERNS.md) for design patterns.
See [Getting Started](docs/getting-started.md) for setup instructions.
See [Advanced Routing](docs/advanced/routing.md) for details.
```

All relative links are converted to absolute paths under `/mini/`:
- `PATTERNS.md` → `/mini/PATTERNS`
- `docs/getting-started.md` → `/mini/docs/getting-started`
- `docs/advanced/routing.md` → `/mini/docs/advanced/routing`

The `.md` extension is optional in URLs and links.

### Linking to API Documentation

Reference classes, functions, and methods from markdown files:

```markdown
The [`Mini`](/Mini) class is the framework singleton.

Use [`render()`](/render) to render views.

The [`InstanceStore`](/Util/InstanceStore) class provides array-like access.

Call [`InstanceStore::offsetExists()`](/Util/InstanceStore::offsetExists) to check if a key exists.
```

**Link format:**
- Classes: `/Namespace/ClassName`
- Functions: `/Namespace/functionName`
- Methods: `/Namespace/ClassName::methodName`

Use backticks around code references for proper formatting.

### Anchor Links Within Documents

Headings automatically get ID anchors:

```markdown
## Getting Started

You can link to [Getting Started](#getting-started) from anywhere.

### Database Configuration

Link to [Database Configuration](#database-configuration) works too.
```

IDs are generated by:
1. Converting heading text to lowercase
2. Replacing non-alphanumeric characters with hyphens
3. Trimming leading/trailing hyphens

Example conversions:
- `Getting Started` → `getting-started`
- `Database Configuration` → `database-configuration`
- `Using @annotations` → `using-annotations`

## Best Practices

### PHP Docblocks

**Structure:**
```php
/**
 * One-line summary (appears in lists)
 *
 * Detailed description with markdown formatting.
 * Can span multiple paragraphs.
 *
 * ## Code Example
 *
 * ```php
 * $result = doSomething($param);
 * ```
 *
 * @param string $param Parameter description
 * @return Result Return value description
 * @throws Exception When something goes wrong
 * @see RelatedClass For related functionality
 */
```

**Guidelines:**
- First line is a brief summary (shown in class/function lists)
- Use markdown for formatting in description
- Include code examples in fenced code blocks
- Reference related classes/methods with `{@see}`
- Document exceptions with `@throws`

### Markdown Files

**Structure:**
```markdown
# Page Title (H1)

Brief introduction paragraph.

## Major Section (H2)

Content here.

### Subsection (H3)

More specific content.

## Another Major Section

Continue with clear hierarchy.
```

**Guidelines:**
- Start every file with exactly one H1 heading
- Use H2 for major sections, H3 for subsections
- Keep heading hierarchy clean (don't skip levels)
- Use code fences with language tags for syntax highlighting
- Link to API docs liberally
- Include practical code examples

### Linking Strategy

**Within same documentation set:**
```markdown
See [Configuration](CONFIG.md) for details.
```

**To API documentation:**
```markdown
The [`Config`](/Config) class handles configuration.
```

**To external resources:**
```markdown
See [PHP Documentation](https://php.net/manual/) for details.
```

**To specific sections:**
```markdown
See [Installation](#installation) above.
```

## Documentation Organization

### **Organizing Large Features**

For larger features or topics, use `index.md` files to create hierarchical documentation:

```
vendor/fubber/mini/
├── README.md              # Root documentation
├── docs/
│   ├── database/
│   │   ├── index.md       # Database overview with links to sub-topics
│   │   ├── queries.md     # Basic queries
│   │   ├── migrations.md  # Schema migrations
│   │   └── advanced.md    # Advanced topics
│   └── routing/
│       ├── index.md       # Routing overview
│       ├── basics.md      # Basic routing
│       └── patterns.md    # Advanced patterns
```

### **Benefits of index.md Files**

**Hierarchical Breadcrumbs:**
- Only directories with `index.md` appear in breadcrumb trail
- Creates clear navigation hierarchy
- Example: `Mini Framework > Database > Queries`

**Navigation Hub:**
- `index.md` serves as table of contents for the feature
- Links to related documents
- Provides context and overview

**Discovery:**
- Place links early in `index.md` - there is no automatic file discovery
- Unlinked documentation files cannot be found by users
- Include clear navigation at the top of index files

### **Example: Feature Index File**

```markdown
# Database

Mini provides a lightweight database abstraction with query building, migrations, and connection pooling.

## Documentation

- [Basic Queries](queries.md) - SELECT, INSERT, UPDATE, DELETE
- [Schema Migrations](migrations.md) - Version control for your database
- [Advanced Topics](advanced.md) - Transactions, prepared statements, optimization

## Quick Start

...rest of overview content...
```

### **Guidelines**

**DO:**
- Create `index.md` for features with multiple related documents
- Link to sub-documents early in the index file (first or second section)
- Use descriptive titles in your H1 headings (they become breadcrumb items)
- Keep file names simple and memorable (e.g., `queries.md`, not `database-query-basics.md`)

**DON'T:**
- Create deeply nested structures (3+ levels deep)
- Put all documentation in a single massive file
- Forget to link to new documents from the index
- Use directory names as documentation (create `index.md` instead)

### **Single Document vs Multiple Documents**

**Use a single document when:**
- Topic is focused and under ~500 lines
- Content flows linearly
- The TOC sidebar provides sufficient navigation

**Use multiple documents with index.md when:**
- Feature has distinct sub-topics
- Document would exceed ~500 lines
- Users may only need specific sections
- Content can be read in any order

## Documentation Rendering Features

All documentation pages include:
- **Table of Contents** - Automatically generated sidebar with intelligent collapsing
- **Syntax Highlighting** - highlight.js for code blocks (190+ languages)
- **Responsive Layout** - Mobile-friendly with Bootstrap 5
- **Deep Linking** - All headings are linkable with URL fragments
- **Breadcrumb Navigation** - Intelligent breadcrumbs for markdown files
- **Search** - Future feature (not yet implemented)

## Writing for Claude Code

When writing documentation that Claude Code will read:

**Be direct:**
- State facts clearly without marketing language
- Use imperative mood for instructions
- Provide complete code examples

**Be structured:**
- Use consistent heading hierarchy
- Group related information together
- Use lists for steps or options

**Be comprehensive:**
- Document all parameters and return values
- Explain edge cases and gotchas
- Show both simple and complex examples

**Be concrete:**
- Provide actual code, not pseudocode
- Use real class/method names from the codebase
- Include file paths and structure

Claude Code can follow complex instructions precisely when documentation is clear and well-structured.
